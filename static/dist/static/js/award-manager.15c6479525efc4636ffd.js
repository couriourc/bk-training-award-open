(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{200:function(t,e,a){"use strict";a.r(e);var n=a(326);var r=a(224);for(var i in r)if(i!=="default")(function(t){a.d(e,t,function(){return r[t]})})(i);var o=a(292);var l=a(3);var s=Object(l["a"])(r["default"],n["a"],n["b"],false,null,"185abeb4",null);e["default"]=s.exports},208:function(t,e,a){"use strict";var n=a(1);Object.defineProperty(e,"__esModule",{value:true});e.deleteAward=m;e.deleteRecord=p;e.getAppliedAwards=d;e.getAvailableAwards=c;e.getAwards=u;e.postAwards=s;e.postRecord=f;e.putAward=h;var r=n(a(5));var i=n(a(6));function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach(function(e){(0,r.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function s(t){return i.default.post("awards/",t)}function u(t,e){return i.default.get("awards/",{params:{page:t,size:e}})}function c(t,e){return i.default.get("get_available_awards/",{params:{page:t,size:e}})}function d(t,e){return i.default.get("get_applyed_awards/",{params:{page:t,size:e}})}function f(t,e){return i.default.post("record/",l({is_draft:t},e))}function p(t){console.log(t);return i.default.put("record/",{id:t})}function m(t){var e=t.awardId;return i.default.delete("awards/",{data:{award_id:e}})}function h(t,e){var a=e.award_name,n=e.award_level,r=e.award_description,o=e.award_consultant,l=e.award_image,s=e.award_department_fullname,u=e.award_reviewers,c=e.start_time,d=e.end_time;return i.default.put("awards/",{award_id:t,award_name:a,award_level:n,award_description:r,award_consultant:o,award_image:l,award_department_fullname:s,award_reviewers:u,start_time:c,end_time:d})}},209:function(t,e,a){"use strict";var n=a(1);Object.defineProperty(e,"__esModule",{value:true});Object.defineProperty(e,"fixMixins",{enumerable:true,get:function t(){return i.default}});Object.defineProperty(e,"tableMixins",{enumerable:true,get:function t(){return r.default}});var r=n(a(210));var i=n(a(211))},210:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var n={data:function t(){return{remoteData:[],pagination:{current:1,count:0,limit:10},tableDataIsLoading:false,tableDataUrl:""}},methods:{handlePageSizeChange:function t(e){this.pagination.current=1;this.pagination.limit=e;this.handleGetPageData(this.pagination.current,e)},handleCurrentChange:function t(e){this.pagination.current=e;this.handleGetPageData(e,this.pagination.limit)},handleGetPageData:function t(e,a){var n=this;var r=this.tableDataUrl;this.tableDataIsLoading=true;return this.$http.get(r).then(function(t){n.remoteData=t.data.results}).finally(function(t){n.tableDataIsLoading=false})}}};e.default=n},211:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var n={data:function t(){},computed:function t(){},mounted:function t(){this.adjustTable()},methods:{adjustTable:function t(){document.querySelector(".main-content").style.minHeight="0";document.querySelector(".main-content").style.height="100%"},notImplemented:function t(e){var a="正在开发: ".concat(e);alert(a);throw new Error(a)}}};e.default=n},224:function(t,e,a){"use strict";a.r(e);var n=a(225);var r=a.n(n);for(var i in n)if(i!=="default")(function(t){a.d(e,t,function(){return n[t]})})(i);e["default"]=r.a},225:function(t,e,a){"use strict";var n=a(1);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var r=n(a(25));var i=n(a(5));var o=a(209);var l=a(16);var s=a(208);var u=a(17);var c=n(a(0));function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach(function(e){(0,i.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var p={name:"award-manager",components:{DialogArea:function t(){return a.e(23).then(a.bind(null,303))},BatchCloneForm:function t(){return a.e(21).then(a.bind(null,305))},BatchSendEmailForm:function t(){return a.e(19).then(a.bind(null,307))},NotificationForm:function t(){return a.e(20).then(a.bind(null,309))},EndAwardForm:function t(){return a.e(22).then(a.bind(null,311))}},mixins:[o.fixMixins,o.tableMixins],data:function t(){return{loading:{newAwardFormLoading:false},config:{award_status:{ended:l.ENDED,not_apply:l.NOT_APPLY,applied:l.APPLYED}},isFilter:"",tableSettings:{awardName:"奖项名称",awardStatus:"状态",startApplyTime:"开始申请时间",endApplyTime:"截止申请时间"},isDialogShow:false,remoteData:[],formData:{},selectData:[],checkData:{}}},computed:{tableData:function t(e){var a,n,r;return(a=(n=e.remoteData)===null||n===void 0?void 0:(r=n.map)===null||r===void 0?void 0:r.call(n,function(t){var e;var a=(0,c.default)(t["start_time"]);var n=(0,c.default)(t["end_time"]);var r=(0,c.default)();if(a.diff(r)>=0){e=l.NOT_APPLY}else if(n.diff(r)<=0){e=l.ENDED}else{e=l.APPLYED}return f(f({},t),{},{awardName:t["award_name"],approval_state:e,awardStatus:l.AWARD_APPROVAL_STATE_MAP[e],startApplyTime:t["start_time"],endApplyTime:t["end_time"]})}))!==null&&a!==void 0?a:[]}},created:function t(){this.handleInit()},mounted:function t(){var e=this;u.bus.$on("set-award-manager-init",function(){e.handleInit()})},methods:{handleInit:function t(){this.handleGetPageData()},toAddNewAward:function t(){this.$router.push({name:"award-form",query:{type:"new"}})},toBatchClone:function t(e,a){if(!a.length){this.messageError("请先选择奖项");return null}e.show()},toSendEmail:function t(e,a){if(!a.length){this.messageError("请先选择奖项");return null}e.show();this.notImplemented("数据接口对接")},toBatchExport:function t(e){this.notImplemented("导出数据")},toSendNotification:function t(e){e.show();this.notImplemented("获取成员信息")},toEditRow:function t(e){return this.$router.push({name:"award-form",query:{type:"edit"},params:f({},e)})},toGetDetail:function t(e){return this.$router.push({name:"award-form",query:{type:"detail"},params:f({},e)})},toEndAward:function t(e,a){a.show()},confirmDelAward:function t(e){var a=this;console.log(e);return(0,s.deleteAward)({awardId:e["id"]}).then(function(t){a.handleInit();a.messageSuccess("删除成功")})},handleSetSelectData:function t(e){this.selectData=(0,r.default)(e)},handlePageSizeChange:function t(e){this.pagination.current=1;this.pagination.limit=e;this.handleGetPageData(this.pagination.current,e)},handleCurrentChange:function t(e){this.pagination.current=e;this.handleGetPageData(e,this.pagination.limit)},handleGetPageData:function t(){var e=this;var a=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.pagination.current;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.pagination.limit;this.isLoading=true;return(0,s.getAwards)(a,n).then(function(t){e.remoteData=t.data["data"];e.pagination.count=t.data["count"]}).finally(function(t){e.isLoading=false})}}};e.default=p},226:function(t,e,a){},292:function(t,e,a){"use strict";var n=a(226);var r=a.n(n);var i=r.a},326:function(t,e,a){"use strict";var n=function(){var t=this;var e=t.$createElement;var a=t._self._c||e;return a("div",{staticClass:"award-container"},[a("div",{staticClass:"header-container f-c-space-arround"},[a("div",{staticClass:"filter-panel"},[a("bk-collapse",{model:{value:t.isFilter,callback:function(e){t.isFilter=e},expression:"isFilter"}},[a("bk-collapse-item",{attrs:{name:"filter-panel","hide-arrow":true,"custom-trigger-area":true}},[a("div",{staticClass:"button-panel",attrs:{slot:"no-trigger"},slot:"no-trigger"},[a("div",{staticClass:"left-panel"},[a("bk-button",{attrs:{theme:"primary",icon:"plus-circle-shape"},on:{click:function(e){t.toAddNewAward()}}},[t._v("\n                                新增\n                            ")]),t._v(" "),a("bk-button",{attrs:{theme:"default"},on:{click:function(e){t.toBatchClone(t.$refs["BatchCloneForm"],t.selectData)}}},[t._v("\n                                批量克隆\n                            ")]),t._v(" "),a("bk-button",{attrs:{theme:"default"},on:{click:function(e){t.toSendEmail(t.$refs["BatchSendEmailForm"],t.selectData)}}},[t._v("\n                                邮件通知\n                            ")]),t._v(" "),a("bk-button",{attrs:{theme:"default"},on:{click:function(e){t.toBatchExport(t.$refs["BatchExportForm"])}}},[t._v("\n                                批量导出\n                            ")]),t._v(" "),a("bk-button",{attrs:{theme:"default"},on:{click:function(e){t.toSendNotification(t.$refs["NotificationForm"])}}},[t._v("\n                                获奖公示\n                            ")])],1)])])],1)],1)]),t._v(" "),a("bk-table",{staticClass:"mt15",attrs:{data:t.tableData,size:"small",pagination:t.pagination},on:{"page-change":function(e){t.handleCurrentChange(e)},"page-limit-change":function(e){t.handlePageSizeChange(e)},"selection-change":t.handleSetSelectData}},[a("bk-table-column",{attrs:{type:"selection",width:"60"}}),t._v(" "),a("bk-table-column",{attrs:{type:"index",label:"序号",width:"60"}}),t._v(" "),t._l(t.tableSettings,function(e,n){return a("bk-table-column",{key:n,attrs:{label:e},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row[n]))])]}}])})}),t._v(" "),a("bk-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{directives:[{name:"show",rawName:"v-show",value:e.row["approval_state"]!==t.config["award_status"]["not_apply"],expression:"props.row['approval_state'] !== config['award_status']['not_apply']"}]},[a("bk-button",{attrs:{theme:"primary",text:true},on:{click:function(a){t.toEditRow(e.row)}}},[t._v("编辑\n                    ")]),t._v(" "),a("bk-popconfirm",{attrs:{title:"确认删除该奖项（"+e.row.awardName+"）？",trigger:"click",content:"删除操作无法撤回，请谨慎操作！"},on:{confirm:function(a){t.confirmDelAward(e.row)}}},[a("bk-button",{attrs:{theme:"primary",text:""}},[t._v("删除")])],1),t._v(" "),a("bk-button",{attrs:{theme:"primary",text:""},on:{click:function(a){t.toGetDetail(e.row,t.$refs["GetDetailDialog"])}}},[t._v("详情")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.row["approval_state"]===t.config["award_status"]["not_apply"],expression:"props.row['approval_state'] === config['award_status']['not_apply']"}]},[a("bk-button",{attrs:{theme:"primary",text:""},on:{click:function(a){t.toEndAward(e.row,t.$refs["EndAwardForm"])}}},[t._v("结束")])],1)]}}])})],2),t._v(" "),a("DialogArea",{ref:"BatchCloneForm",attrs:{title:"批量克隆"}},[a("BatchCloneForm",{attrs:{slot:"custom","form-data":t.selectData,"total-data":t.tableData},slot:"custom"})],1),t._v(" "),a("DialogArea",{ref:"BatchSendEmailForm",attrs:{title:"批量发送邮件"}},[a("BatchSendEmailForm",{attrs:{slot:"custom","select-data":t.selectData},slot:"custom"})],1),t._v(" "),a("DialogArea",{ref:"NotificationForm",attrs:{title:"编辑公示"}},[a("NotificationForm",{attrs:{slot:"custom","select-data":t.selectData},slot:"custom"})],1),t._v(" "),a("DialogArea",{ref:"EndAwardForm",attrs:{title:"结束奖项"}},[a("EndAwardForm",{attrs:{slot:"custom"},slot:"custom"})],1)],1)};var r=[];a.d(e,"a",function(){return n});a.d(e,"b",function(){return r})}}]);