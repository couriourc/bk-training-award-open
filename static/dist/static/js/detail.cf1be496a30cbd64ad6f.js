(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{208:function(a,t,r){"use strict";r.r(t);var e=r(385);var p=r(257);for(var o in p)if(o!=="default")(function(a){r.d(t,a,function(){return p[a]})})(o);var l=r(338);var n=r(7);var i=Object(n["a"])(p["default"],e["a"],e["b"],false,null,"9fb32918",null);t["default"]=i.exports},213:function(a,t,r){"use strict";var e=r(1);Object.defineProperty(t,"__esModule",{value:true});t.getApplicationById=i;t.getAwardApplication=s;t.getAwardApproval=o;t.getRecord=l;t.postApproval=n;var p=e(r(3));function o(a){var t=a.page,r=a.size,e=a.group_id,o=a.approval_status;return p.default.get("/approval/",{params:{page:t,size:r,group_id:e,approval_status:o}})}function l(a){var t=a.page,r=a.size,e=a.group_id,o=a.apply_status;return p.default.get("record/",{params:{page:t,size:r,group_id:e,apply_status:o}})}function n(a){var t=a.id,r=a.action,e=a.approval_text;return p.default.post("/approval/",{id:t,action:r,approval_text:e})}function i(a){return p.default.get("/application/".concat(a,"/"))}function s(a){return p.default.get("/award_application/".concat(a,"/"))}},257:function(a,t,r){"use strict";r.r(t);var e=r(258);var p=r.n(e);for(var o in e)if(o!=="default")(function(a){r.d(t,a,function(){return e[a]})})(o);t["default"]=p.a},258:function(a,t,r){"use strict";var e=r(1);Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var p=e(r(9));var o=e(r(10));var l=r(8);var n=r(213);var i={name:"detail",components:{ApprovalList:function a(){return r.e(42).then(r.bind(null,365))},DetailInfo:function a(){return r.e(18).then(r.bind(null,366))},ApplyForm:function a(){return r.e(17).then(r.bind(null,368))}},props:{type:{type:String,default:function a(){return null}}},provide:function a(){var t=this;return{awardDetail:function a(){return t.$refs["award-detail"].awardForm||{}}}},data:function a(){return{isShow:false,applyForm:{},panelCutOut:false,pageType:{apply:l.DETAIL_APPLY,apply_detail:l.DETAIL_APPLY_DETAIL,draft_detail:l.DETAIL_DRAFT_DETAIL,approval_detail:l.DETAIL_APPROVAL_DETAIL},approvalForm:{approvalVisible:false,approvalLoading:false,approvalText:"",approvalTips:""},approvalFormRules:Object.freeze({approvalText:[{required:true,message:"请填写评语",trigger:"blur"}]}),approvalTabItems:[{"tab-name":"审批列表","tab-key":"approval-list"}],approvalType:{pass:1,not_pass:0}}},computed:{isShowApplyForm:function a(){return[l.DETAIL_APPLY,l.DETAIL_EDIT,l.DETAIL_DRAFT_DETAIL].includes(this.formType)},formType:function a(t){return t.$route.query[l.DETAIL_TYPE_KEYNAME]||"detail"}},created:function a(){this.handleInit()},methods:{handleInit:function a(){this.applyForm=this.$route.params},trigglePanel:function a(){this.panelCutOut=!this.panelCutOut},toApproval:function a(t,r){this.approvalForm.approvalTips=t;this.approvalForm.approvalVisible=true;this.approvalForm.action=r},handlePostApproval:function a(t){var r=this;var e=t.approvalTips,l=t.approvalText,i=t.action;return(0,o.default)(p.default.mark(function a(){var t;return p.default.wrap(function a(p){while(1){switch(p.prev=p.next){case 0:p.next=2;return r.$refs["approval-form"].validate();case 2:t=r.$route.query["apply_id"];r.approvalForm.approvalLoading=true;return p.abrupt("return",(0,n.postApproval)({id:t,action:i,approval_text:l}).then(function(a){r.messageSuccess(e);r.approvalForm.approvalVisible=false;r.approvalForm.approvalLoading=false}));case 5:case"end":return p.stop()}}},a)}))()}}};t.default=i},259:function(a,t,r){},338:function(a,t,r){"use strict";var e=r(259);var p=r.n(e);var o=p.a},385:function(a,t,r){"use strict";var e=function(){var a=this;var t=a.$createElement;var r=a._self._c||t;return r("div",{staticClass:"detail-container"},[r("top-back"),a._v(" "),a.formType===a.pageType["approval"]?r("div",{class:["approval-list"]},[r("div",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tip-button",on:{click:a.trigglePanel}},[a._v("\n            "+a._s(a.panelCutOut?"展开":"收起")+"\n        ")]),a._v(" "),r("div",{class:["approval-content",{not_active:a.panelCutOut}]},[r("tabs",{staticStyle:{height:"100%"},attrs:{"tab-items":a.approvalTabItems}},[[r("approval-list",{tag:"component"})]],2)],1)]):a._e(),a._v(" "),r("div",{staticClass:"board"},[r("div",[r("bk-divider",{staticStyle:{width:"100%"}})],1),a._v(" "),r("div",{staticClass:"form-panel"},[r("DetailInfo",{ref:"award-detail",staticClass:"detail",attrs:{type:"award_detail"}}),a._v(" "),r("ApplyForm",{ref:"apply-form",staticClass:"form"})],1)]),a._v(" "),a.formType===a.pageType["approval_detail"]?r("div",{staticClass:"tc w100  mt15"},[r("div",{staticClass:"button-item"},[r("bk-button",{staticClass:"mr20 ml20",attrs:{theme:"danger","ext-cls":"button-item"},on:{click:function(t){a.toApproval("拒绝"+a.$refs["apply-form"].applyForm.application_users+"的申请",a.approvalType["not_pass"])}}},[r("bk-icon",{attrs:{type:"close-circle"}}),a._v(" "),r("span",[a._v("不通过")])],1),a._v(" "),r("bk-button",{staticClass:"mr20 ml20",attrs:{theme:"success","ext-cls":"button-item"},on:{click:function(t){a.toApproval("通过"+a.$refs["apply-form"].applyForm.application_users+"的申请",a.approvalType["pass"])}}},[r("span",[a._v("通过")]),a._v(" "),r("bk-icon",{attrs:{type:"check-circle"}})],1)],1)]):a._e(),a._v(" "),r("bk-dialog",{attrs:{"header-position":"left",loading:a.approvalForm.approvalLoading,title:a.approvalForm.approvalTips},on:{confirm:function(t){a.handlePostApproval(a.approvalForm)}},model:{value:a.approvalForm.approvalVisible,callback:function(t){a.$set(a.approvalForm,"approvalVisible",t)},expression:"approvalForm.approvalVisible"}},[r("bk-form",{ref:"approval-form",attrs:{rules:a.approvalFormRules,model:a.approvalForm}},[r("bk-form-item",{attrs:{property:"approvalText",required:true,"label-width":80,label:"评语"}},[r("bk-input",{attrs:{placeholder:"请输入不超过255字的评语",type:"textarea",rows:3,maxlength:255},model:{value:a.approvalForm.approvalText,callback:function(t){a.$set(a.approvalForm,"approvalText",t)},expression:"approvalForm.approvalText"}})],1)],1)],1)],1)};var p=[];r.d(t,"a",function(){return e});r.d(t,"b",function(){return p})}}]);