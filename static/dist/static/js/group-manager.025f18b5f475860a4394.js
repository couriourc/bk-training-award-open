(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{199:function(t,e,n){"use strict";n.r(e);var a=n(325);var r=n(221);for(var i in r)if(i!=="default")(function(t){n.d(e,t,function(){return r[t]})})(i);var o=n(291);var u=n(3);var l=Object(u["a"])(r["default"],a["a"],a["b"],false,null,"516978bc",null);e["default"]=l.exports},209:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:true});Object.defineProperty(e,"fixMixins",{enumerable:true,get:function t(){return i.default}});Object.defineProperty(e,"tableMixins",{enumerable:true,get:function t(){return r.default}});var r=a(n(210));var i=a(n(211))},210:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var a={data:function t(){return{remoteData:[],pagination:{current:1,count:0,limit:10},tableDataIsLoading:false,tableDataUrl:""}},methods:{handlePageSizeChange:function t(e){this.pagination.current=1;this.pagination.limit=e;this.handleGetPageData(this.pagination.current,e)},handleCurrentChange:function t(e){this.pagination.current=e;this.handleGetPageData(e,this.pagination.limit)},handleGetPageData:function t(e,n){var a=this;var r=this.tableDataUrl;this.tableDataIsLoading=true;return this.$http.get(r).then(function(t){a.remoteData=t.data.results}).finally(function(t){a.tableDataIsLoading=false})}}};e.default=a},211:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var a={data:function t(){},computed:function t(){},mounted:function t(){this.adjustTable()},methods:{adjustTable:function t(){document.querySelector(".main-content").style.minHeight="0";document.querySelector(".main-content").style.height="100%"},notImplemented:function t(e){var n="正在开发: ".concat(e);alert(n);throw new Error(n)}}};e.default=a},221:function(t,e,n){"use strict";n.r(e);var a=n(222);var r=n.n(a);for(var i in a)if(i!=="default")(function(t){n.d(e,t,function(){return a[t]})})(i);e["default"]=r.a},222:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:true});e.default=void 0;var r=a(n(5));var i=n(209);var o=n(160);var u=n(16);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach(function(e){(0,r.default)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var c={name:u.GROUP_MANAGER_ROUTE_PATH,components:{GroupDialog:function t(){return n.e(27).then(n.bind(null,302))}},filters:{groupLevel:function t(e){var t=e.split&&e.split("/").slice(-1)[0];return t||e}},mixins:[i.fixMixins,i.tableMixins],data:function t(){return{newGroupLoading:false,tableSettings:{group_full_name:"组织名",master:"负责人"},remoteData:[]}},computed:{tableData:function t(e){var n,a;var r=e.remoteData;return(n=r===null||r===void 0?void 0:(a=r.map)===null||a===void 0?void 0:a.call(r,function(t,e){return s(s({},t),{},{group_level:t["group_full_name"],master:t["secretaries"]})}))!==null&&n!==void 0?n:[]}},created:function t(){this.handleInit()},methods:{handleInit:function t(){return Promise.all([this.handleGetPageData()])},toAddNewGroup:function t(e){e.show()},toEditRow:function t(e,n){e.show({data:n})},handlePageChange:function t(e){this.pagination.page=e;return this.handleGetPageData(e,this.pagination.limit)},handlePageLimitChange:function t(e){this.pagination.page=1;this.pagination.limit=e;return this.handleGetPageData(this.pagination.page,e)},handleGetPageData:function t(){var e=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.pagination.page;var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.pagination.limit;this.tableDataIsLoading=true;return(0,o.getSecretary)(n,a).then(function(t){e.pagination.count=t.data["count"];e.remoteData=t.data["results"]}).finally(function(t){e.tableDataIsLoading=false})},handleConfirmAddNewGroup:function t(e,n){var a=this;if(this.newGroupLoading){return}this.newGroupLoading=true;return(0,o.postSecretary)(e).then(function(t){a.messageSuccess("创建成功");a.handleInit();n.hidden()}).finally(function(t){a.newGroupLoading=false})},handleConfirmEditGroup:function t(e,n){var a=this;return(0,o.putSecretary)(e.id,e).then(function(t){a.messageSuccess("修改成功");a.handleInit();n.hidden()}).catch(function(t){a.messageError("修改失败")})}}};e.default=c},223:function(t,e,n){},291:function(t,e,n){"use strict";var a=n(223);var r=n.n(a);var i=r.a},325:function(t,e,n){"use strict";var a=function(){var t=this;var e=t.$createElement;var n=t._self._c||e;return n("div",{staticClass:"group-manager-container"},[t.$store.getters.groupPowerConfig["add-new-group"]?n("bk-button",{attrs:{theme:"primary",icon:"plus-circle-shape"},on:{click:function(e){t.toAddNewGroup(t.$refs["newGroupDialogForm"])}}},[t._v("\n        指派秘书\n    ")]):t._e(),t._v(" "),n("bk-table",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.tableDataIsLoading,title:"加载中"},expression:"{ isLoading: tableDataIsLoading ,title: '加载中' }"}],attrs:{size:"small","ext-cls":"mt15",data:t.tableData,pagination:t.pagination,"highlight-current-row":true,"max-height":"80%"},on:{"page-change":function(e){t.handlePageChange(e)},"page-limit-change":function(e){t.handlePageLimitChange(e)}}},[n("bk-table-column",{attrs:{type:"index",label:"序号",width:80}}),t._v(" "),n("bk-table-column",{key:"group_full_name",attrs:{label:"组织名"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row["group_full_name"]))])]}}])}),t._v(" "),n("bk-table-column",{key:"group_level",attrs:{label:"组织级别"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("groupLevel")(e.row["group_full_name"])))])]}}])}),t._v(" "),n("bk-table-column",{key:"group_full_name",attrs:{label:"秘书"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row["master"]||[],function(e){return n("bk-tag",{key:e["username"]},[t._v("\n                    "+t._s(e["username"])+"（"+t._s(e["display_name"])+"）\n                ")])})}}])}),t._v(" "),t.$store.getters.groupPowerConfig["table-controller"]?n("bk-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("bk-button",{attrs:{theme:"primary",outline:true,text:true},on:{click:function(n){t.toEditRow(t.$refs["EditorDialogForm"],e.row)}}},[t._v("编辑\n                ")])]}}])}):t._e()],1),t._v(" "),t.$store.getters.groupPowerConfig["add-new-group"]?n("GroupDialog",{ref:"newGroupDialogForm",attrs:{"dialog-type":"creator",loading:t.newGroupLoading},on:{confirm:function(e){t.handleConfirmAddNewGroup(e,t.$refs["newGroupDialogForm"])}}}):t._e(),t._v(" "),t.$store.getters.groupPowerConfig["table-controller"]?n("GroupDialog",{ref:"EditorDialogForm",attrs:{"dialog-type":"editor","group-disabled":true},on:{confirm:function(e){t.handleConfirmEditGroup(e,t.$refs["EditorDialogForm"])}}}):t._e()],1)};var r=[];n.d(e,"a",function(){return a});n.d(e,"b",function(){return r})}}]);